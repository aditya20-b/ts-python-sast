id: PY.SECRET.HARDCODED
title: Potential hardcoded secret
severity: medium
description: >
  Hardcoded secrets in source code can be extracted by attackers and
  should be stored in environment variables or secure configuration.
message: Store secrets in environment variables or secure configuration
patterns:
  - kind: string_literal
    regex: '(?i)(password|passwd|pwd|secret|key|token|api[_-]?key)\s*=\s*["\'][^"\']{8,}["\']'
  - kind: string_literal
    regex: 'AKIA[0-9A-Z]{16}'  # AWS Access Key pattern
  - kind: string_literal
    regex: '[0-9a-f]{32}'  # MD5-like hash
  - kind: string_literal
    regex: '[0-9a-f]{40}'  # SHA1-like hash
examples:
  bad: API_KEY = "abc123secretkey456"
  good: API_KEY = os.environ.get("API_KEY")
tags:
  - secrets
  - credentials
  - configuration
references:
  - "https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication"